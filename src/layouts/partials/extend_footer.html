<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js" defer></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  if (typeof gsap === 'undefined') return;
  gsap.registerPlugin(ScrollTrigger);

  gsap.utils.toArray('.skill-item').forEach((item, i) => {
    const bar = item.querySelector('.skill-bar-fill');
    const percent = bar?.dataset.percent;

    gsap.from(item, {
      scrollTrigger: { trigger: item, start: 'top 85%' },
      duration: 0.5,
      opacity: 0,
      x: -20,
      delay: i * 0.05
    });

    if (bar && percent) {
      gsap.to(bar, {
        scrollTrigger: { trigger: item, start: 'top 85%' },
        width: percent + '%',
        duration: 1,
        delay: i * 0.05 + 0.2,
        ease: 'power2.out'
      });
    }
  });

  gsap.utils.toArray('.timeline-item').forEach((item, i) => {
    gsap.from(item, {
      scrollTrigger: { trigger: item, start: 'top 85%' },
      duration: 0.6,
      opacity: 0,
      x: -20,
      delay: i * 0.15
    });
  });

  gsap.utils.toArray('.cert-item').forEach((item, i) => {
    gsap.from(item, {
      scrollTrigger: { trigger: item, start: 'top 85%' },
      duration: 0.5,
      opacity: 0,
      y: 20,
      delay: i * 0.08
    });
  });

  const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

  if (isTouchDevice) {
    document.querySelectorAll('.timeline-item').forEach(item => {
      item.addEventListener('click', function(e) {
        const wasExpanded = this.classList.contains('expanded');

        document.querySelectorAll('.timeline-item').forEach(otherItem => {
          otherItem.classList.remove('expanded');
        });

        if (!wasExpanded) {
          this.classList.add('expanded');
        }
      });
    });
  }
});
</script>
